import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import make_circles
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense

# Generate spiral-like features using make_circles
X, y = make_circles(n_samples=500, factor=0.3, noise=0.1)

# Build NN
model = Sequential([
    Dense(4, activation='linear', input_shape=(2,)),
    Dense(4, activation='linear'),
    Dense(4, activation='linear'),
    Dense(1, activation='sigmoid')
])

# Compile & Train
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])
history = model.fit(X, y, epochs=100, verbose=0)

# Accuracy
print("Final Accuracy:", model.evaluate(X, y, verbose=0)[1])

# Visualization
plt.scatter(X[:, 0], X[:, 1], c=y, cmap="viridis")
plt.title("Spiral-Features Dataset")
plt.show()
